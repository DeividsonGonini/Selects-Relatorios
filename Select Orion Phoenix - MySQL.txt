ORÇAMENTOS - PRODUTOS LIRIO / TULIPA


SELECT 
	ORCAMENTO.NUMERO AS 'ORÇAMENTO',
    ORCAMENTO.DATA,
    PARCEIRO.CODIGO,
    PARCEIRO.NOME AS 'CLIENTE',
    ENDERECO_PARCEIRO.CIDADE,
    UF.DESCRICAO AS 'UF',
    PRODUTO.CODIGO AS 'CODIGO DO PRODUTO',
    PRODUTO.DESCRICAO,
	ITEM_ORCAMENTO.QUANTIDADE,
    ITEM_ORCAMENTO.VALOR_UNITARIO AS 'VALOR UNIT DO PRODUTO',
    ITEM_ORCAMENTO.VALOR_DESCONTO AS 'DESCONTO DO PRODUTO',
    ITEM_ORCAMENTO.VALOR_LIQUIDO AS 'TOTAL DO PRODUTO',
    ORCAMENTO.VALOR_TOTAL AS 'VALOR TOTAL DO PEDIDO'
	FROM PARCEIRO INNER JOIN ORCAMENTO
	ON PARCEIRO.ID = ORCAMENTO.PARCEIRO_ID
	LEFT JOIN ITEM_ORCAMENTO
    ON ORCAMENTO.ID = ITEM_ORCAMENTO.ORCAMENTO_ID
    LEFT JOIN PRODUTO
    ON PRODUTO.ID = ITEM_ORCAMENTO.PRODUTO_ID
    LEFT JOIN ENDERECO_PARCEIRO
    ON PARCEIRO.ID = ENDERECO_PARCEIRO.PARCEIRO_ID
    LEFT JOIN UF
    ON UF.ID = ENDERECO_PARCEIRO.UF_ID
    LEFT JOIN GRUPO_PRODUTO
    ON GRUPO_PRODUTO.ID = PRODUTO.GRUPO_PRODUTO_ID
	WHERE 
    (GRUPO_PRODUTO.DESCRICAO LIKE '%LIRIO%'
    OR GRUPO_PRODUTO.DESCRICAO LIKE '%TULIPA%')
    AND MONTH(ORCAMENTO.DATA) = MONTH('2014-10-03')   
	AND YEAR(ORCAMENTO.DATA) = YEAR('2014-10-03')







_______________________________________________________



ORÇAMENTOS - POR DATA



SELECT
	ORCAMENTO.NUMERO AS 'ORÇAMENTO',
    ORCAMENTO.DATA,
    PARCEIRO.CODIGO,
    PARCEIRO.NOME AS 'CLIENTE',
    ENDERECO_PARCEIRO.CIDADE,
    UF.DESCRICAO AS 'UF',
    PRODUTO.CODIGO AS 'CODIGO DO PRODUTO',
    PRODUTO.DESCRICAO,
  	ITEM_ORCAMENTO.QUANTIDADE,
    ITEM_ORCAMENTO.VALOR_UNITARIO AS 'VALOR UNIT DO PRODUTO',
    ITEM_ORCAMENTO.VALOR_DESCONTO AS 'DESCONTO DO PRODUTO',
    ITEM_ORCAMENTO.VALOR_LIQUIDO AS 'TOTAL DO PRODUTO',
    ORCAMENTO.VALOR_TOTAL AS 'VALOR TOTAL DO PEDIDO'
	FROM PARCEIRO INNER JOIN ORCAMENTO
	ON PARCEIRO.ID = ORCAMENTO.PARCEIRO_ID
	LEFT JOIN ITEM_ORCAMENTO
    ON ORCAMENTO.ID = ITEM_ORCAMENTO.ORCAMENTO_ID
    LEFT JOIN PRODUTO
    ON PRODUTO.ID = ITEM_ORCAMENTO.PRODUTO_ID
    LEFT JOIN ENDERECO_PARCEIRO
    ON PARCEIRO.ID = ENDERECO_PARCEIRO.PARCEIRO_ID
    LEFT JOIN UF
    ON UF.ID = ENDERECO_PARCEIRO.UF_ID
    LEFT JOIN GRUPO_PRODUTO
    ON GRUPO_PRODUTO.ID = PRODUTO.GRUPO_PRODUTO_ID
	WHERE
    PRODUTO.CODIGO = 1140018
    AND BETWEEN ORCAMENTO.DATA ('2015-01-01' AND '2015-05-05')




__________________________________________________________________



ORÇAMENTOS - PRODUTOS POR  CLIENTE


SELECT
	ORCAMENTO.NUMERO AS 'ORÇAMENTO',
    ORCAMENTO.DATA,
    PARCEIRO.CODIGO,
    PARCEIRO.NOME AS 'CLIENTE',
    ENDERECO_PARCEIRO.CIDADE,
    UF.DESCRICAO AS 'UF',
    PRODUTO.CODIGO AS 'CODIGO DO PRODUTO',
    PRODUTO.DESCRICAO,
  	ITEM_ORCAMENTO.QUANTIDADE,
    ITEM_ORCAMENTO.VALOR_UNITARIO AS 'VALOR UNIT DO PRODUTO',
    ITEM_ORCAMENTO.VALOR_DESCONTO AS 'DESCONTO DO PRODUTO',
    ITEM_ORCAMENTO.VALOR_LIQUIDO AS 'TOTAL DO PRODUTO',
    ORCAMENTO.VALOR_TOTAL AS 'VALOR TOTAL DO PEDIDO'
	FROM PARCEIRO INNER JOIN ORCAMENTO
	ON PARCEIRO.ID = ORCAMENTO.PARCEIRO_ID
	LEFT JOIN ITEM_ORCAMENTO
    ON ORCAMENTO.ID = ITEM_ORCAMENTO.ORCAMENTO_ID
    LEFT JOIN PRODUTO
    ON PRODUTO.ID = ITEM_ORCAMENTO.PRODUTO_ID
    LEFT JOIN ENDERECO_PARCEIRO
    ON PARCEIRO.ID = ENDERECO_PARCEIRO.PARCEIRO_ID
    LEFT JOIN UF
    ON UF.ID = ENDERECO_PARCEIRO.UF_ID
    LEFT JOIN GRUPO_PRODUTO
    ON GRUPO_PRODUTO.ID = PRODUTO.GRUPO_PRODUTO_ID
	WHERE
    PARCEIRO.CODIGO = 150001

_____________________________________

/*RELATORIO NOTAS FISCAIS*/

  SELECT
  DATA AS 'EMISSAO',
  NUMERO AS 'Nº DA NOTA',
  CLIENTE_CODIGO AS 'COD. CLIENTE',
  CLIENTE_NOME AS 'CLIENTE',
  SITUACAO AS 'SITUAÇÃO',
  CONDICAO_PAGAMENTO_DESC AS 'COND. PAGAMENTO',
  VALOR_FINAL AS 'VALOR TOTAL',
  CFOP_PRINCIPAL_COD AS 'CFOP'
  FROM NOTA_FISCAL
  WHERE
  MONTH(DATA) = MONTH('2015-05-04')
  AND SERIE = 1


___________________________________________


/*RELATORIO faturamento NOTAS FISCAIS */

  SELECT
  DATA AS 'EMISSAO',
  NUMERO AS 'Nº DA NOTA',
  CLIENTE_CODIGO AS 'COD. CLIENTE',
  CLIENTE_NOME AS 'CLIENTE',
  SITUACAO AS 'SITUAÇÃO',
  CONDICAO_PAGAMENTO_DESC AS 'COND. PAGAMENTO',
  VALOR_FINAL AS 'VALOR TOTAL',
  CFOP_PRINCIPAL_COD AS 'CFOP'
  FROM NOTA_FISCAL
  WHERE
  DATE DATA BETWEEN 2015-05-01 AND 2015-05-14,
  AND
  SERIE = 1
  AND CLIENTE_CODIGO BETWEEN 1 AND '150001'
  ORDER BY 1


______________________________________________




/*RELATORIO DE FATURAMENTO POR NOTA FISCAL*/

 

SELECT
  NOTA_FISCAL.DATA AS 'EMISSAO',
  NOTA_FISCAL.NUMERO AS 'Nº DA NOTA',
  NOTA_FISCAL.CLIENTE_CODIGO AS 'COD. CLIENTE',
  NOTA_FISCAL.CLIENTE_NOME AS 'CLIENTE',
  NOTA_FISCAL.CLIENTE_CNPJ_CPF AS 'CNPJ / CPF',
  NOTA_FISCAL.CLIENTE_CIDADE AS 'CIDADE',
  NOTA_FISCAL.CLIENTE_UF AS 'ESTADO',
    CASE (NOTA_FISCAL.SITUACAO)
      WHEN 4 THEN 'Autorizada'
      WHEN 1 THEN 'Gerada'
      WHEN 0 THEN 'Cancelada'
      WHEN 3 THEN 'Assinada'
      WHEN 5 THEN 'Denegada'
      WHEN 7 THEN 'Rejeitada'
      WHEN 10 THEN 'Inutilizada'
    ELSE 'OUTRO MES'
    END 'SITUAÇÃO',
  NOTA_FISCAL.CFOP_PRINCIPAL_COD AS 'CFOP',
  ITEM_NOTA_FISCAL.PRODUTO_CODIGO AS 'CODIGO',
  ITEM_NOTA_FISCAL.PRODUTO_DESCRICAO AS 'NOME',
  ITEM_NOTA_FISCAL.UNIDADE_MEDIDA_ID AS 'UND',
  ITEM_NOTA_FISCAL.QUANTIDADE_LIBERADA AS 'QUANTIDADE FATURADA',
  ITEM_NOTA_FISCAL.VALOR_UNITARIO_LIQUIDO AS 'VALOR UNIT',
  ITEM_NOTA_FISCAL.VALOR_TOTAL AS 'TOTAL POR PRODUTO ',
  NOTA_FISCAL.VALOR_TOTAL AS 'VALOR NOTA SEM FRETE',
  NOTA_FISCAL.VALOR_FRETE AS 'FRETE',
  NOTA_FISCAL.VALOR_DESPESAS AS 'DESPESAS',
  NOTA_FISCAL.VALOR_DESCONTO AS 'DESCONTO',
  NOTA_FISCAL.VALOR_FINAL AS 'VALOR TOTAL NOTA',
  NOTA_FISCAL.CONDICAO_PAGAMENTO_DESC AS 'COND. PAGAMENTO',
  NOTA_FISCAL.FORMA_PAGAMENTO_DESC AS 'FORMA DE PAGAMENTO',
  NOTA_FISCAL.NOTA_SAIDA_TIPO AS 'FORMA DE SAIDA',
  NOTA_FISCAL.SERIE AS 'SERIE'
  FROM
    NOTA_FISCAL INNER JOIN ITEM_NOTA_FISCAL
  ON
    NOTA_FISCAL.ID = ITEM_NOTA_FISCAL.NOTA_FISCAL_ID
  WHERE
    NOTA_FISCAL.DATA BETWEEN (DATE_SUB(CURDATE(), INTERVAL 6 MONTH)) AND (CURDATE())
  AND
     NOTA_FISCAL.SERIE = 1
  AND
    NOTA_FISCAL.NOTA_SAIDA_TIPO = 'Revenda ou Produção'

___________________

	FATURAMENTO POR MES


 SELECT
  NOTA_FISCAL.DATA AS 'EMISSAO',
  NOTA_FISCAL.NUMERO AS 'Nº DA NOTA',
  NOTA_FISCAL.CLIENTE_CODIGO AS 'COD. CLIENTE',
  NOTA_FISCAL.CLIENTE_NOME AS 'CLIENTE',
  NOTA_FISCAL.CLIENTE_CNPJ_CPF AS 'CNPJ / CPF',
  NOTA_FISCAL.CLIENTE_CIDADE AS 'CIDADE',
  NOTA_FISCAL.CLIENTE_UF AS 'ESTADO',
  	CASE (NOTA_FISCAL.SITUACAO)
  WHEN 4 THEN 'Autorizada'
  WHEN 1 THEN 'Gerada'
  WHEN 0 THEN 'Cancelada'
	WHEN 3 THEN 'Assinada'
  WHEN 5 THEN 'Denegada'
	WHEN 7 THEN 'Rejeitada'
	WHEN 10 THEN 'Inutilizada'
	ELSE 'OUTRO MES'
  END 'SITUAÇÃO',
  NOTA_FISCAL.CFOP_PRINCIPAL_COD AS 'CFOP',
  ITEM_NOTA_FISCAL.PRODUTO_CODIGO AS 'CODIGO',
  ITEM_NOTA_FISCAL.PRODUTO_DESCRICAO AS 'NOME',
  ITEM_NOTA_FISCAL.UNIDADE_MEDIDA_ID AS 'UND',
  ITEM_NOTA_FISCAL.QUANTIDADE_LIBERADA AS 'QUANTIDADE FATURADA',
  ITEM_NOTA_FISCAL.VALOR_UNITARIO_LIQUIDO AS 'VALOR UNIT',
  ITEM_NOTA_FISCAL.VALOR_TOTAL AS 'TOTAL POR PRODUTO ',
  NOTA_FISCAL.VALOR_TOTAL AS 'VALOR NOTA SEM FRETE',
  NOTA_FISCAL.VALOR_FRETE AS 'FRETE',
  NOTA_FISCAL.VALOR_DESPESAS AS 'DESPESAS',
  NOTA_FISCAL.VALOR_DESCONTO AS 'DESCONTO',
  NOTA_FISCAL.VALOR_FINAL AS 'VALOR TOTAL NOTA',
  NOTA_FISCAL.CONDICAO_PAGAMENTO_DESC AS 'COND. PAGAMENTO',
  NOTA_FISCAL.FORMA_PAGAMENTO_DESC AS 'FORMA DE PAGAMENTO',
  NOTA_FISCAL.NOTA_SAIDA_TIPO AS 'FORMA DE SAIDA',
  NOTA_FISCAL.SERIE AS 'SERIE'
  FROM
  NOTA_FISCAL INNER JOIN ITEM_NOTA_FISCAL
  ON
  NOTA_FISCAL.ID = ITEM_NOTA_FISCAL.NOTA_FISCAL_ID
  WHERE
  (MONTH (NOTA_FISCAL.DATA) = 4 AND YEAR (NOTA_FISCAL.DATA) = 2015)
  AND
  NOTA_FISCAL.SERIE = 1
  AND
  NOTA_FISCAL.NOTA_SAIDA_TIPO = 'Revenda ou Produção'



_______________________

/* PRODUTOS EM ABERTO */



SELECT

    SITUACAO_PEDIDO_VENDA.DESCRICAO AS 'SITUAÇÃO PED.',
    PEDIDO_VENDA.NUMERO AS 'PEDIDO VENDA',
    PEDIDO_VENDA.DATA 'DATA',
    PARCEIRO.CODIGO AS 'COD. PARCEIRO',
    PARCEIRO.NOME AS 'CLIENTE',
    ENDERECO_PARCEIRO.CIDADE,
    UF.DESCRICAO AS 'UF',
    PRODUTO.CODIGO AS 'COD. PRODUTO',
    PRODUTO.DESCRICAO,
    ITEM_PEDIDO_VENDA.QUANTIDADE AS 'QTD',
    ITEM_PEDIDO_VENDA.QTD_TOTAL_IMPORTADO AS 'QTD IMPORTADA',
    ITEM_PEDIDO_VENDA.QUANTIDADE - ITEM_PEDIDO_VENDA.QTD_TOTAL_IMPORTADO AS 'QTD PENDENTE',
    ITEM_PEDIDO_VENDA.PRECO_UNITARIO AS 'VALOR UNIT DO PRODUTO',
    ITEM_PEDIDO_VENDA.VALOR_DESCONTO AS 'DES. DO PRODUTO',
    ITEM_PEDIDO_VENDA.VALOR_LIQUIDO AS 'TOTAL DO PRODUTO',
    PEDIDO_VENDA.VALOR_TOTAL AS 'VALOR TOTAL DO PEDIDO VENDA'
	FROM PARCEIRO INNER JOIN PEDIDO_VENDA
	ON PARCEIRO.ID = PEDIDO_VENDA.PARCEIRO_ID
	LEFT JOIN ITEM_PEDIDO_VENDA
    ON PEDIDO_VENDA.ID = ITEM_PEDIDO_VENDA.PEDIDO_VENDA_ID
    LEFT JOIN PRODUTO
    ON PRODUTO.ID = ITEM_PEDIDO_VENDA.PRODUTO_ID
    LEFT JOIN ENDERECO_PARCEIRO
    ON PARCEIRO.ID = ENDERECO_PARCEIRO.PARCEIRO_ID
    LEFT JOIN UF
    ON UF.ID = ENDERECO_PARCEIRO.UF_ID
    LEFT JOIN GRUPO_PRODUTO
    ON GRUPO_PRODUTO.ID = PRODUTO.GRUPO_PRODUTO_ID
    INNER JOIN SITUACAO_PEDIDO_VENDA
    ON  SITUACAO_PEDIDO_VENDA.ID = PEDIDO_VENDA.SITUACAO_PEDIDO_VENDA_ID
  WHERE
  PEDIDO_VENDA.DATA BETWEEN ('2015-04-01') AND (CURDATE())
  AND
  ITEM_PEDIDO_VENDA.QUANTIDADE - ITEM_PEDIDO_VENDA.QTD_TOTAL_IMPORTADO > 0
  AND
  PEDIDO_VENDA.EMPRESA_ID = 1

  ORDER BY 3


__________________________________________________

/* Relatorio deFaturamento sem itens*/
SELECT DISTINCT
  NOTA_FISCAL.DATA AS 'EMISSAO',
  NOTA_FISCAL.NUMERO AS 'Nº DA NOTA',
  NOTA_FISCAL.CLIENTE_CODIGO AS 'COD. CLIENTE',
  NOTA_FISCAL.CLIENTE_NOME AS 'CLIENTE',
  NOTA_FISCAL.CLIENTE_CNPJ_CPF AS 'CNPJ / CPF',
  NOTA_FISCAL.CLIENTE_CIDADE AS 'CIDADE',
  NOTA_FISCAL.CLIENTE_UF AS 'ESTADO',
	CASE (NOTA_FISCAL.SITUACAO)
  WHEN 4 THEN 'Autorizada'
  WHEN 1 THEN 'Gerada'
  WHEN 0 THEN 'Cancelada'
	WHEN 3 THEN 'Assinada'
  WHEN 5 THEN 'Denegada'
	WHEN 7 THEN 'Rejeitada'
	WHEN 10 THEN 'Inutilizada'
	ELSE 'OUTRO MES'
  END 'SITUAÇÃO',
  NOTA_FISCAL.CFOP_PRINCIPAL_COD AS 'CFOP',
  NOTA_FISCAL.VALOR_TOTAL AS 'VALOR NOTA SEM FRETE',
  NOTA_FISCAL.VALOR_FRETE AS 'FRETE',
  NOTA_FISCAL.VALOR_DESPESAS AS 'DESPESAS',
  NOTA_FISCAL.VALOR_DESCONTO AS 'DESCONTO',
  NOTA_FISCAL.VALOR_FINAL AS 'VALOR TOTAL NOTA',
  NOTA_FISCAL.CONDICAO_PAGAMENTO_DESC AS 'COND. PAGAMENTO',
  NOTA_FISCAL.FORMA_PAGAMENTO_DESC AS 'FORMA DE PAGAMENTO',
  NOTA_FISCAL.NOTA_SAIDA_TIPO AS 'FORMA DE SAIDA',
  NOTA_FISCAL.SERIE AS 'SERIE'
  FROM
  NOTA_FISCAL INNER JOIN ITEM_NOTA_FISCAL
  ON
  NOTA_FISCAL.ID = ITEM_NOTA_FISCAL.NOTA_FISCAL_ID
  WHERE
  NOTA_FISCAL.DATA BETWEEN (DATE_SUB(CURDATE(), INTERVAL 6 MONTH)) AND (CURDATE())
  AND
  NOTA_FISCAL.SERIE = 1
  AND
  NOTA_FISCAL.NOTA_SAIDA_TIPO = 'Revenda ou Produção'
